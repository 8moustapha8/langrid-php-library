<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <script type="text/javascript">var _sf_startpt = (new Date()).getTime()</script>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>多言語工房PHPライブラリチュートリアル</title>

    <link href="./public/css/common.css" rel="stylesheet" type="text/css"/>
    <link href="./public/css/manual.css" rel="stylesheet" type="text/css"/>
    <link rel="shortcut icon" href="./public/img/common/favicon.png"/>

</head>
<body>

<!-- header -->
<div class="header">
        <div class="header_inner">
            <div class="logo logo_subpage">
                <a href="./">
                    <span class="logo_button"></span>
                </a>
                <span class="logo_title"><a href="./developer.html">PHPライブラリ</a></span>
            </div>
            <div class="header_right">
                <form action="http://google.co.jp/search" class="search_form">
                    <input type="text" name="q" class="query" value="">
                    <input type="hidden" name="as_sitesearch" value="langrid.org">
                </form>
            </div>
        </div>
</div>

<style>
    .applybutton {
        width: 342px;
        height: 57px;
        border-radius: 6px;
        backgound-color: #00A8E4;
        background: -moz-linear-gradient(top, #43C4F2, #00A8E4);
        background: -webkit-gradient(linear, left top, left bottom, from(#43C4F2), to(#00A8E4));
        display: inline-block;
        margin-right: 20px;
        text-align: center;
        line-height: 57px;
        font-size: 14px;
    }

    .applybutton a {
        display: block;
        color: white;
        font-weight: bold;
        text-decoration: none;
    }

    h3 {
        border-bottom: 0;
    }

</style>

<!-- content -->
<div class="content">
    <p><a href="/">ホーム</a> &gt; <a href="./developer.html">多言語工房トップ</a> &gt; <a href="phplibrary.html">PHPライブラリ</a> &gt; チュートリアル</p>
    <h1>多言語工房PHPライブラリチュートリアル</h1>
    <div class="section">
    <h2 id="sec_summary">目次</h2>
      <li><a href="#sec_share">0. 共通の準備</a></li>
      <li><a href="#sec_atomic">1. 原子サービスを使う</a></li>
      <li><a href="#sec_composite1">2. 複合サービスを使う</a></li>
      <li><a href="#sec_sample">3. サンプル</a></li>
    </ul>
    </div>
    <div class="section">
    <h2 id="sec_share">0. 共通の準備</h2>
    <h4>前準備</h4>
    <p>言語グリッドを利用するには，言語グリッドユーザIDとパスワードが必要です．お持ちでない方は<a href="http://langrid.org/operation/jp/procedure.html">言語グリッド京都オペレーションセンター - 言語グリッドへの参加</a>より申し込んで下さい．</p>
    <h4>ダウンロードと配備</h4>
    <p>以下のリンクよりライブラリをダウンロードして下さい．利用条件は，アーカイブファイルに含まれるREADMEを参照して下さい．この言語グリッドPHPライブラリは，<b>PHP5.3</b>以上で動作します．</p>
    <div class="applybutton">
    <a href="https://github.com/langrid/langrid-php-library/zipball/master">多言語工房PHPライブラリをダウンロード</a>
    </div>
    </p>
    <p>
    ダウンロードしたファイルを解凍し，以下の様に配備します．
    </p>
    <pre>	
        アプリケーションルート
        |- yourfile.php [サービスを利用するphpスクリプト]
        |- langrid-php-library [ライブラリのルート]
            |- MultiLanguageStudio.php
            |- client
            |- config
            |- ・・・</pre>
            <p>
            
                                各クライアントを利用するためにはライブラリのインポートが必要です．
                    インポートはライブラリのルートディレクトリにある「MultiLanguageStudio.php」をインポートすることで行います．
            </p>
    </div>
    <div style="text-align: right;"><a href="#sec_summary">Top↑</a></div>
    <div class="section">
    <h2 id="sec_atomic">1. 原子サービスを使う</h2>
    <p>原子サービスは，単体で動作するサービスです．J-Server (Kyoto-U)という翻訳サービスを利用する例を示します．</p>  
    <h4>サービスタイプの選択とサービスの検索</h4>
    <p>はじめに，使用するサービスのタイプを選びます．<a href="http://langrid.org/service_manager/service-type">Language Grid Service Managerのサービスタイプページ</a>から，自分の使用したいServiceを選び出します．ここでは，Translationを選んだとします．</p>
    <p>つづいて，使用するサービスを決定します．<a href="http://langrid.org/service_manager/language-services">Language Grid Service Managerのlanguage servicesページ</a>において，Service TypeにTranslationを指定し，Searchボタンを押すと，Service TypeがTranslationであるサービスが列挙されます．ここで，J-Server (Kyoto-U)を使うサービスとして決めたとします．</p>
    <p><a href="http://langrid.org/service_manager/language-services/profile/kyoto1.langrid/KyotoUJServer">J-Server (Kyoto-U)</a>をクリックすると，J-Server (Kyoto-U)サービスの詳細が表示されます．Atomic or Compositeの欄を見ると，Atomic Serviceであることが分かります．また，WSDLの欄を見ると，WSDLのURLが<a href="http://langrid.org/service_manager/wsdl/kyoto1.langrid:KyotoUJServer">http://langrid.org/service_manager/wsdl/kyoto1.langrid:KyotoUJServer</a>であることが分かります．</p>
    <h4>APIの確認</h4>
    <p>
    Service TypeがTranslationのサービスクライアントは，TranslationClientになります．<a href="http://www.langrid.org/developer/phplibrary.html#TranslationClient">TranslationClientのAPIのページ</a>を見ると，translateというメソッドを持つことが分かります．</p>    
    <h4>ソースコード</h4>
    <p>「0. 共通の準備」で指定した位置にyourfile.phpを作成し，以下のコードを書き込みます．このPHPファイルを実行すると，J-Server (Kyoto-U)を使って翻訳をすることができます．</p>
    <pre>
    //yourfile.php
    &lt;?php
        // 言語グリッドPHPライブラリをインポート
        require_once dirname(__FILE__).'/langrid-php-library/MultiLanguageStudio.php';

        // 使用するサービスのWSDLのURLを指定
        $url = 'http://langrid.org/service_manager/wsdl/kyoto1.langrid:KyotoUJServer';

        try{
            // 該当するサービスタイプ(今回はTranslation)を指定して，クライアントを作成
            $client = ClientFactory::createTranslationClient($url);

            // サービス認証情報の設定．※※必ずUserIDとパスワードを設定※※
            $client->setUserId('');
            $client->setPassword('');  

            // APIマニュアルのメソッド情報に基づき，サービスを呼び出す．
            $result = $client->translate(
                Language::get('ja'),
                Language::get('en'),
                '今日は良い天気です．');

             echo $result;
             //var_dump($result); 
             // -> It's fine today.
        } catch(Exception $e) {
            var_dump($e);
        }
    ?&gt;

    </pre>
    </div>
    <div style="text-align: right;"><a href="#sec_summary">Top↑</a></div>
      <h2 id="sec_composite1">2. 複合サービスを使う</h2>
      <p>準備中</p>
    <div style="text-align: right;"><a href="#sec_summary">Top↑</a></div>
    <h2 id="sec_sample">3. サンプル</h2>
    <p>簡易なサンプルを三つ紹介します．</p>
                <h3>3.1 TranslationWithTemporalDictionaryサービスの利用</h3>

                <p>
                    TranslationWithTemporalDictionaryはもっとも基本的な翻訳機能を提供します．
                </p>
                    <pre>
        $url = 'http://langrid.org/service_manager/wsdl/TranslationCombinedWithBilingualDictionary';

        try{
            // サービスクライアントの作成
            $client = ClientFactory::createTranslationWithTemporalDictionaryClient($url);

            // サービス認証情報の設定（サービス全体でデフォルトの認証を利用する場合は省略できます．[後述]）
            $client->setUserId('someUserId');
            $client->setPassword('somePassword');	

            // バインディングサービスの設定
            $client->addBindings(new BindingNode("BilingualDictionaryPL", "KyotoTourismDictionaryDb"));
            $client->addBindings(new BindingNode("TranslationPL", "GoogleTranslate"));


            // サービスの呼び出し
            $result = $client->translate(
                Language::get('ja'),
                Language::get('en'),
                '京都の比叡山を含む東山は東山３６峰とも呼ばれています．',
                array(
                    new Translation('東山３６峰', array('HIGASHIYAMA36HOU'))
                ),
                Language::get('en'));

            var_dump($result); 
            // -> Hiei in Kyoto Higashiyama, including is also known as the HIGASHIYAMA36HOU .
        } catch(Exception $e) {
            var_dump($e);
        }</pre>
            <p>
            <strong>解説：</strong><br />
            <code>addBindings</code>で，利用する外部サービスの名前を指定します．このサンプルでは，翻訳時に参照する辞書として<code>KyotoTourismDictionaryDb</code>を指定しています．これにより旅行関連（KyotoTourismDictionaryDbに登録されている単語）の翻訳精度が向上します．<br>
            また翻訳エンジンには<code>GoogleTranslate</code>を指定しています．翻訳エンジン毎に翻訳結果の癖が異なります．<br />
            <code>new Translation('東山３６峰', array('HIGASHIYAMA36HOU'))</code>では，ローカル辞書の値を翻訳関数に引き渡しています．
            これによってサービスグリッドの辞書に登録されていない単語であっても，ローカル辞書に存在すれば正しく翻訳する事が可能となります．<br />
            </p>
                <div style="text-align: right;"><a href="#sec_summary">Top↑</a></div>

                <h3>3.2 TextToSpeechサービスの利用</h3>
                <p>
                TextToSpeechサービスは文字列を指定した言語で発音させることができます．
                </p>
                <pre>
        $url = 'http://langrid.org/service_manager/wsdl/VoiceText';

        try {
            // サービスクライアントの作成
            $this->client = ClientFactory::createTextToSpeechClient($url);

            // サービス認証情報の設定（サービス全体でデフォルトの認証を利用する場合は省略できます．[後述]）
            $client->setUserId('someUserId');
            $client->setPassword('somePassword');

            // サービスの呼び出し
            $result = $this->client->speak(
                Language::get('ja'),  // 元データの言語 (getSupportedLanguagesにより取得する)
                'こんにちは',          // 音声変換したい文章()
                'man',               // 音声データの声の種類(getSupportedVoiceTypesにより取得する) 
                'audio/x-wav'        // 音声データのフォーマット(getSupportedAudioTypesにより取得する)
            );

            //　受信データの書き出し このファイルをブラウザ等の音楽プレイヤーを使って再生する
            $fp = fopen("Hello.wav", "w"); 
            fwrite($fp, $result->audio);
            fclose($fp);

        } catch(Exception $e) {
            var_dump($e);
        }</pre>
    <div style="text-align: right;"><a href="#sec_summary">Top↑</a></div>
                <h3>3.3 BilingualDictionaryサービスの利用</h3>
                <p>
                BilingualDictionaryサービスはサービスグリッドが保有する辞書データを検索するサービスを提供します．
                </p>
                <pre>
        $url = 'http://langrid.org/service_manager/wsdl/Lsd';

        try {
            // サービスクライアントの作成
            $this->client = ClientFactory::createBilingualDictionaryClient($url);

            // サービス認証情報の設定（サービス全体でデフォルトの認証を利用する場合は省略できます．[後述]）
            $client->setUserId('someUserId');
            $client->setPassword('somePassword');

            // サービスの呼び出し
            $result = $this->client->search(Language::get('ja'), Language::get('en'), '科学', MatchingMethod::COMPLETE);

            var_dump($result->targetWords);
            // array(2) { [0]=> string(7) "science" [1]=> string(3) "sci" }
        } catch(Exception $e) {
            var_dump($e);
        }</pre>        
    <div style="text-align: right;"><a href="#sec_summary">Top↑</a></div>
</div>
<!-- footer begin-->
<div class="footer">
    <div class="footer">
        <div class="fotter_border"></div>
        <div class="footer_logo">
            <p class="copyright">Copyright (C) Language Grid All Rights Reserved.</p>
        </div>
    </div>
</div>
<!-- footer end-->
</body>
</html>

